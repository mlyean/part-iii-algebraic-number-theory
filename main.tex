\documentclass[11pt]{article}
\usepackage[utf8]{inputenc}
\usepackage[a4paper]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{array}
\usepackage{chngcntr}
\usepackage{commath}
\usepackage{comment}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{stmaryrd}
\usepackage{thmtools}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage{titlesec}
\usepackage[cal=boondox]{mathalfa}

\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]
\newtheorem{example}[definition]{Example}
\newtheorem*{example*}{Example}
\newtheorem{notation}[definition]{Notation}

\theoremstyle{plain}
\newtheorem{theorem}[definition]{Theorem}
\newtheorem{proposition}[definition]{Proposition}
\newtheorem{lemma}[definition]{Lemma}
\newtheorem{corollary}[definition]{Corollary}

\theoremstyle{remark}
\newtheorem{remark}[definition]{Remark}
\newtheorem*{remark*}{Remark}

\renewcommand{\qedsymbol}{$\blacksquare$}

\DeclareMathOperator{\Gal}{Gal}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Cl}{Cl}
\DeclareMathOperator{\res}{res}

\newcommand{\FF}{\mathbb{F}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\cp}{\mathcal{p}}
\newcommand{\fa}{\mathfrak{a}}
\newcommand{\ff}{\mathfrak{f}}
\newcommand{\fp}{\mathfrak{p}}
\newcommand{\fq}{\mathfrak{q}}
\newcommand{\fm}{\mathfrak{m}}
\newcommand{\fn}{\mathfrak{n}}
\newcommand{\leg}[2]{\left(\frac{#1}{#2}\right)}

\setlist[enumerate,1]{label=\arabic*), nosep}
\setlist[itemize,1]{nosep}

% Uncomment to exclude proofs
% \excludecomment{proof}

\title{Part III Algebraic Number Theory Lecture Notes}
\author{Ming Yean Lim}

\begin{document}

\maketitle

\noindent These lecture notes were based on the Part III course Algebraic Number Theory taught during Lent 2023 by Dr. Hanneke Wiersema.

% \tableofcontents

% \newcommand{\sectionbreak}{\clearpage}

\stepcounter{section}

\subsection{Recap of Algebraic Number Theory}

Let $K$ be a number field, $\cO_K$ the ring of integers of $K$. Let $L/K$ be a finite extension of number fields. Let $\fp$ be a prime ideal of $\cO_K$, then $\fp \cO_L$ is an ideal in $\cO_L$, and factors as $\fp \cO_L = \cp_1^{e_1} \ldots, \cp_g^{e_g}$, where $\cp_i$ are distinct primes ideals of $\cO_L$.

Suppose $\cp \subseteq \cO_L$. If $\cp \mid \fp \cO_L$, then we say that $\cp$ \emph{lies above} $\fp$, or $\fp$ \emph{lies under} $\cp$. Note that
\begin{equation*}
    \cp \mid \fp \cO_L \iff \fp = \cp \cap \cO_K \iff \fp \subseteq \cp
\end{equation*}

The $e_i = e_{\cp_i / \fp}$ is called the \emph{ramification index} of $\cp_i$ over $\fp$. We say that $\fp$ \emph{ramifies} in $L$ if $e_i > 1$ for some $i$.

For $\cp \subseteq \cO_L$, write $k_\cp = \cO_L / \cp$ for the corresponding residue field. Similarly, set $k_\fp = \cO_K / \fp$.

If $\cp \mid \fp$, we have an extension of residue fields $k_\cp / k_\fp$. The degree of this extension is called the \emph{inertial degree} of $\cp$ over $\fp$, denoted $f = f_{\cp / \fp}$.

\begin{theorem}\label{thm:1_1}
    Let $\fp \subseteq \cO_K$ and $\fp \cO_K = \cp_1^{e_1} \ldots \cp_g^{e_g}$ as above. Then
    \begin{equation*}
        [L : K] = \sum_{i=1}^{\infty} e_i f_i
    \end{equation*}
\end{theorem}

\subsubsection*{Galois Extensions}

Let $L/K$ be Galois.

\begin{theorem}\label{thm:1_2}
    Let $\fp \subseteq \cO_K$ be a prime ideal.
    \begin{enumerate}
        \item The Galois group $\Gal(L/K)$ acts transitively on primes of $\cO_L$ lying above $\fp$, i.e. if $\cp, \cp' \mid \fp$, then there is a $\sigma \in \Gal(L/K)$ such that $\sigma(\cp) = \cp'$.

        \item Primes $\cp_1, \ldots, \cp_g$ of $\cO_L$ lying above $\fp$ have the same ramification index $e$ and inertial degree $f$, so that $[L : K] = e f g$.
    \end{enumerate}
\end{theorem}

\noindent Let $\cp \subseteq \cO_L$ be such that $\cp \mid \fp$.

\begin{definition}
    The \emph{decomposition group} of $\cp$ is
    \begin{equation*}
        D_{\cp / \fp} = \{\sigma \in \Gal(L/K) \mid \sigma(\cp) = \cp\}
    \end{equation*}
    and the \emph{inertial group} is
    \begin{equation*}
        I_{\cp / \fp} = \{\sigma \in \Gal(L/K) \mid \forall \alpha \in \cO_L, \sigma(\alpha) \equiv \alpha \pmod{\cp}\}
    \end{equation*}
    Note that $I_{\cp/\fp} \subseteq D_{\cp/\fp}$.
\end{definition}

The extension of residue fields $k_\cp / k_\fp$ is Galois. Each $\sigma \in D_{\cp / \fp}$ induces an automorphism $\widetilde{\sigma}$ on $k_\cp$, which is the identity on $k_\fp$. We have a map $D_{\cp / \fp} \to \Gal(k_\cp / k_\fp)$, $\sigma \mapsto \widetilde{\sigma}$.

\begin{proposition}\label{prop:1_4}\phantom{}
    \begin{enumerate}
        \item $\Gal(k_\cp / k_\fp)$ is a cyclic group with canonical generator the Frobenius automorphism $x \mapsto x^q$, where $q = \abs{\cO_K / \fp}$.

        \item We have a surjective homomorphism $D_{\cp / \fp} \to \Gal(k_\cp / k_\fp)$, $\sigma \mapsto \widetilde{\sigma}$ with kernel $I_{\cp / \fp}$.

        \item $\abs{I_{\cp / \fp}} = e_{\cp / \fp}$, $\abs{D_{\cp / \fp}} = e_{\cp / \fp} f_{\cp / \fp}$.
    \end{enumerate}
\end{proposition}

\subsection{The Artin Symbol}

\begin{lemma}\label{lem:1_5}
    Let $L/K$ be Galois, and $\fp \subseteq \cO_K$ unramified in $L$. Suppose $\cp \subseteq \cO_L$ is such that $\cp \mid \fp$. Then there exists a unique $\sigma \in \Gal(L/K)$ such that for all $\alpha \in \cO_L, \sigma(\alpha) \equiv \alpha^{N(\fp)} \pmod{\cp}$, where $N(\fp) = \abs{\cO_K / \fp}$.
\end{lemma}
\begin{proof}
    By \autoref{prop:1_4}, since $\fp$ is unramified, $\abs{I_{\cp / \fp}} = 0$, and so $D_{\cp / \fp} \cong \Gal(k_\cp / k_\fp)$. Let $\sigma \in D_{\cp / \fp}$ be the unique element mapping to the Frobenius automorphism $x \mapsto x^q$. Note that $q = N(\fp)$, so we find that
    \begin{equation}\label{eqn:1_5_star}
        \sigma(\alpha) \equiv a^{N(\fp)} \pmod{\cp} \qquad \forall \alpha \in \cO_L
    \end{equation}
    Note that any $\sigma \in \Gal(L/K)$ satisfying \eqref{eqn:1_5_star} is an element of $D_{\cp / \fp}$, so uniqueness follows.
\end{proof}

\begin{definition}\label{def:1_6}
    The unique element from \autoref{lem:1_5} is called the \emph{Artin symbol}, denoted $\leg{L/K}{\cp}$.
\end{definition}

\begin{corollary}\label{cor:1_7}
    Let $L/K$ be Galois, $\fp \subseteq \cO_K$ unramified, $\cp \subseteq \cO_L$ lying above $\fp$. Then
    \begin{enumerate}
        \item $\leg{L/K}{\sigma(\cp)} = \sigma \leg{L/K}{\cp} \sigma^{-1}$ for all $\sigma \in \Gal(L/K)$;

        \item The order of $\leg{L/K}{\cp}$ is $f = f_{\cp / \fp}$;

        \item $\fp$ splits completely in $L$ if and only if $\leg{L/K}{\cp} = 1$.
    \end{enumerate}
\end{corollary}
\begin{proof}\phantom{}
    \begin{enumerate}
        \item Follows from uniqueness of the Artin symbol, details will be an exercise.

        \item Since $\abs{I_{\cp / \fp}} = 1$, we have $D_{\cp / \fp} \cong \Gal(k_\cp / k_\fp)$. The Artin symbol maps to a generator of $\Gal(k_\cp / k_\fp)$, which has order $f_{\cp / \fp}$.

        \item Note that $\fp$ splits completely in $L$ means that $e = f = 1$. Since $\fp$ is unramified, $e = 1$. Thus by $2)$, $\leg{L/K}{\cp} = 1$ if and only if $f = 1$. \qedhere
    \end{enumerate}
\end{proof}

\begin{definition}\label{def:1_8}
    We say $L/K$ is an \emph{abelian extension} if $L/K$ is Galois with abelian Galois group.
\end{definition}

If $L/K$ is abelian, then $\leg{L/K}{\cp}$ depends only on $\fp$: Let $\cp' \subseteq \cO_L$ be a prime lying over $\fp$. Then $\cp' = \sigma(\cp)$ for some $\sigma \in \Gal(L/K)$ by \autoref{thm:1_2}. Then
\begin{equation*}
    \leg{L/K}{\cp'} = \leg{L/K}{\sigma(\cp)} = \sigma \leg{L/K}{\cp} \sigma^{-1} = \leg{L/K}{\cp}
\end{equation*}
by \autoref{cor:1_7}.

\begin{notation}\label{not:1_9}
    If $L/K$ is abelian, write $\leg{L/K}{\fp}$ for the Artin symbol for any $\cp / \fp$.
\end{notation}

\begin{example}\label{eg:1_10}
    Let $K = \QQ$, $L = \QQ(\sqrt{d})$, where $d \in \ZZ$ is squarefree. Recall that the discriminant is
    \begin{equation*}
        D = D_{L/K} =
        \begin{cases}
            d &\text{if } d \equiv 1 \pmod{4}\\
            4d &\text{otherwise}
        \end{cases}
    \end{equation*}
    and that $\fp = (p)$ ramifies in $L$ if and only if $p \mid D$. Identify $\Gal(L/K)$ with the multiplicative group $\{\pm 1\}$. Let $(p)$ be unramified. Then
    \begin{equation*}
        \leg{\QQ(\sqrt{d}) / \QQ}{(p)} = \leg{D}{p}
    \end{equation*}
    where $\leg{D}{p}$ is the Kronecker symbol.
\end{example}

\stepcounter{section}

\subsection{Some Background and Recap}

\begin{definition}\label{def:2_1}
    A \emph{fractional ideal} of $K$ is a non-zero $\cO_K$-submodule $\fa$ of $K$ such that there is a non-zero $x \in \cO_K$ such that $x \fa \subseteq \cO_K$.
\end{definition}

\begin{notation}\label{not:2_2}
    The set of fractional $\cO_K$-ideals is a group, which we denote by $I_K$. We write $P_K$ for the subgroup of principal fractional ideals.
\end{notation}

\begin{remark}\label{rem:2_3}
    Recall that for any $\fa \in I_K$, we have a unique prime factorisation
    \begin{equation}\label{eqn:2_3_fact}
        \fa = \prod_{i=1}^\infty \fp_i^{r_i}
    \end{equation}
    where $r_i \in \ZZ$, and the $\fp_i$'s are distinct prime ideals of $\cO_K$.
\end{remark}

\subsection{The Artin Map for Unramified Extensions}
We will extend the Artin symbol to non-prime ideals, in particular, we can use the above factorisation to extend it to any $\fa \in I_K$.

\begin{definition}\label{def:2_4}
    Suppose $L/K$ is abelian and unramified, then we define the \emph{Artin map} to be the homomorphism $\leg{L/K}{\cdot} : I_K \to \Gal(L/K)$ by setting
    \begin{equation}\label{eqn:2_4_star}
        \leg{L/K}{\fa} = \prod_{i=1}^r \leg{L/K}{\fp_i}^{r_i}
    \end{equation}
    for $\fa$ with factorisation \eqref{eqn:2_3_fact}.
\end{definition}

\subsection{The Artin Map for Abelian Extensions}

If $L/K$ is unramified, we can define the Artin symbol for unramified primes, but not all primes. To define the Artin map, we work with a subgroup of $I_K$.

\begin{definition}[Modulus]\label{def:2_5}
    Let $K$ be a number field, then a \emph{modulus} in $K$ is a formal product
    \begin{equation*}
        \fm = \prod_\fp \fp^{n_\fp}
    \end{equation*}
    over all primes $\fp$, finite and infinite\footnote{see the section on finite and infinite primes later}, such that
    \begin{enumerate}
        \item $n_\fp \ge 0$ and at most finitely many are non-zero;
        \item $n_\fp = 0$ if $\fp$ is a complex infinite prime;
        \item $n_\fp \le 1$ is $\fp$ is a real infinite prime.
    \end{enumerate}
    When all exponents $n_\fp = 0$, then we set $\fm = 1$.
\end{definition}

\begin{example}\label{eg:2_6}
    If $K$ is a purely imaginary field\footnote{a number field that cannot be embedded into $\RR$}, then a modulus is just an ideal of $\cO_K$.
\end{example}

\begin{definition}\label{def:2_7}
    Let $\fm$ be a modulus, we define $I_K(\fm)$ to be the group of all fractional $\cO_K$-ideals of $\cO_K$ are relatively prime to $\fm$.
\end{definition}

For any $\fm$, we can write $\fm = \fm_0 \fm_\infty$, where $\fm_0$ is the finite part, and $\fm_\infty$ is the infinite part. Paing relatively prime to $\fm$ means being relatively prime to $\fm_0$.

\begin{example}\label{eg:2_8}
    If $\fm = 1$, then $I_K(\fm) = I_K$.
\end{example}

\begin{example}\label{eg:2_9}
    If $K = \QQ$, $\fm = (m)$ where $m$ is any integer, then
    \begin{equation*}
        I_\QQ(\fm) = \bigg\{ \frac{a}{b}\ZZ \,\bigg\vert\, (a, m) = (b, m) = 1 \bigg\}
    \end{equation*}
\end{example}

Let $L/K$ be abelian. Let $\fm$ be a modulus of $K$ that is divisible by all unramified primes of $K$, then for each $\fp$ in $I_K(\fm)$, we can define the Artin symbol $\leg{L/K}{\fp} \in \Gal(L/K)$.

\begin{definition}\label{def:2_10}
    Let $\fm$ be as above, then the \emph{Artin map} for $L/K$ and $\fm$ is a homomorphism $\Phi_{\fm} : I_K(\fm) \to \Gal(L/K)$ defined by extending the Artin symbol multiplicatively as in \eqref{eqn:2_4_star}.
\end{definition}

\begin{example}\label{eg:2_11}
    Let $\fm$ be a positive integer, $\zeta_m$ a primitive $m$\textsuperscript{th} root of unity. Let $K = \QQ$, $L = \QQ(\zeta_m)$. Recall that
    \begin{enumerate}
        \item $\Gal(\QQ(\zeta_m) / \QQ) \cong (\ZZ / m \ZZ)^\times$, where the isomorphism sends $\sigma : \zeta_m \mapsto \zeta_m^h$ to $[h]$;
        \item If a prime $\fp$ ramifies in $\QQ(\zeta_m)$, then $p \mid m$.
    \end{enumerate}
    Write $\infty$ for the real infinite prime of $\QQ$. Let $\fm = (m) \infty$. Then $\fm$ contains all ramified primes, so we have a well-defined map $\Phi_\fm : I_\QQ(\fm) \to \Gal(\QQ(\zeta_m) / \QQ)$.

    For a prime $p \nmid m$, let $\cp$ be a prime lying over $(p)$. Let $\sigma = \leg{L/K}{\cp}$. Then by definition, $\sigma(\zeta_m) \equiv \zeta_m^p \pmod{\cp}$. Write $\sigma(\zeta_m) = \zeta_m^h$ for some $h \in \ZZ$. Then $1 - \zeta_m^{h-p} \in \cp$, but $1 - \zeta_m^{h-p}$ is a unit unless $h \equiv p \pmod{m}$. Thus $\sigma(\zeta_m) = \zeta_m^p$, so $\Phi((p)) = [p] \in (\ZZ / m \ZZ)^\times$.

    Let $\frac{a}{b}\ZZ \in I_\QQ(\fm)$, then $\Phi_\fm(\frac{a}{b} \ZZ) = [a][b]^{-1} \in (\ZZ / m \ZZ)^\times$.
    The map is clearly surjective.
\end{example}

\subsection{Generalised Ideal Class Group}

\begin{definition}\label{def:2_12}
    Let $P_K(\fm)$ be the subgroup of $I_K(\fm)$ consisting of all principal fractional ideals $(\alpha)$, where $\alpha \in K$ is such that
    \begin{itemize}
        \item $v_\fp(\alpha - 1) \ge v_\fp(\fm_0) = n_\fp$ for any $\fp \mid \fm_0$;
        \item $\sigma(\alpha) > 0$ for every real infinite prime $\sigma \mid \fm_\infty$.
    \end{itemize}
\end{definition}

\begin{example}\label{eg:2_13}
    Let $\fm = 1$, then $P_K(\fm) = P_K$.
\end{example}

\begin{example}\label{eg:2_14}
    Let $K = \QQ$, $\fm = (m)$. Note a fractional ideal $(\alpha)$ is generated by both $+\alpha$ and $-\alpha$. If $(\alpha) \in P_\QQ(\fm)$, then we must have $v_p(\alpha - 1) \ge v_p(m)$ for $p \mid m$, so
    \begin{equation*}
        P_\QQ(\fm) = \bigg\{\frac{a}{b}\ZZ \in I_\QQ(\fm) \,\big\vert\, a \equiv b \pmod{m}\bigg\}
    \end{equation*}

    \noindent Next let $\fm' = (m) \infty$, then $I_\QQ(\fm') = I_\QQ(\fm')$, but $P_\QQ(\fm) \neq P_\QQ(\fm')$, as
    \begin{equation*}
        P_\QQ(\fm') = \bigg\{\frac{a}{b}\ZZ \in I_\QQ(\fm) \,\big\vert\, a \equiv b \pmod{m},\, \frac{a}{b} > 0\bigg\}
    \end{equation*}
\end{example}

\begin{remark}\label{remark:2_15}
    In the setting of \autoref{eg:2_11}, we have $\ker \Phi_\fm = P_\QQ(\fm)$ for $\fm = (m) \infty$.
\end{remark}

The group $P_K(\fm)$ for any $K$ or $\fm$ is sometimes called a \emph{ray}, or the \emph{ray group}.

\begin{proposition}\label{prop:2_16}
    The subgroup $P_K(\fm)$ has finite index in $I_K(\fm)$.
\end{proposition}
\begin{proof}
    Omitted, a special case will be an exercise.
\end{proof}

\subsubsection*{Interlude -- Finite an Infinite Primes}
A \emph{finite prime} is a prime ideal of $\cO_K$. An \emph{infinite prime} is determined by embeddings of $K \hookrightarrow \CC$.
\begin{itemize}
    \item A \emph{real infinite prime} is an embedding $K \hookrightarrow \RR$;
    \item A \emph{complex infinite prime} is a pair of complex conjugate embeddings $\sigma, \overline{\sigma} \hookrightarrow \CC$, $\sigma \neq \overline{\sigma}$.
\end{itemize}

\begin{remark*}
    Compare this with places or absolute values, archimedian and non-archimedian, from the Local Fields course.
\end{remark*}

\begin{example*}\phantom{}
    \begin{itemize}
        \item $\QQ$ has one real infinite prime, which is the identity.
        \item $\QQ(\sqrt{2})$ has two real infinite primes, determined by $\sigma(\sqrt{2}) = \sqrt{2}$ and $\sigma(\sqrt{2}) = -\sqrt{2}$.
        \item $\QQ(\sqrt{-2})$ has one pair of complex infinite primes, $\sigma(\sqrt{-2}) = \sqrt{-2}$ and $\overline{\sigma}(\sqrt{-2}) = -\sqrt{-2}$.
    \end{itemize}
\end{example*}

\begin{remark*}
    Let $L/K$ be an extension of number fields, an infinite prime $\sigma$ of $K$ ramifies in $L$ if $\sigma$ is real and extends to a complex prime of $L$.
\end{remark*}

\begin{example*}
    The real infinite prime of $\QQ$ is unramified in $\QQ(\sqrt{2})$, but ramified in $\QQ(\sqrt{-2})$.
\end{example*}

\noindent Now we return to the topic of generalised ideal class groups.

\begin{definition}\label{def:2_17}
    A subgroup $H \subseteq I_K(\fm)$ is a \emph{congruence subgroup} for $\fm$ if $P_K(\fm) \subseteq H \subseteq I_K(\fm)$.
\end{definition}

\begin{definition}\label{def:2_18}
    Let $H$ be a congruence subgroup for $\fm$. Then the quotient $I_K(\fm)/H$ is a \emph{generalised ideal class group}.
\end{definition}

\begin{definition}\label{def:2_19}
    The quotient $I_K(\fm)/P_K(\fm)$ is called the \emph{ray class group}.
\end{definition}

\begin{example}\label{eg:2_20}
    Let $\fm = 1$, $I_K(\fm)/P_K(\fm) = I_K/P_K = \Cl(K)$, where $\Cl(K)$ is the ideal class group of $K$.
\end{example}

\begin{proposition}\label{prop:2_21}
    Write $P_\fm \subseteq I_K(\fm)$ for the subgroup of principal fractional ideals that are relatively prime to $\fm$. Thern we have an exact sequence
    \begin{equation*}
        1 \longrightarrow P_\fm/P_K(\fm) \longrightarrow I_K(\fm)/P_K(\fm) \longrightarrow \Cl(K) \longrightarrow 1
    \end{equation*}
\end{proposition}

\begin{remark}\label{rem:2_22}
    In fact, writing $h_K(\fm) = \abs{I_K(\fm)/P_K(\fm)}$, we can use this to show $h_K \mid h_K(\fm)$, where $h_K$ is the class number of $K$.
\end{remark}

\begin{remark}\label{rem:2_23}
    If we have any $\cO_K$-ideal $I$, then every ideal class in $\Cl(K)$ can be represented by an ideal coprime to $I$.
\end{remark}

\begin{proof}[Proof of \autoref{prop:2_21} (Sketch)]
    Let $\fa \in I_K(\fm)$. Define $h : I_K(\fm) \to \Cl(K)$ by $h(\fa) = [\fa] \in \Cl(K)$. This is a surjective\footnote{use \autoref{rem:2_23}} group homomorphism with kernel $P_\fm$. Thus we have an exact sequence
    \begin{equation*}
        1 \longrightarrow P_\fm \longrightarrow I_K(\fm) \longrightarrow \Cl(K) \longrightarrow 1
    \end{equation*}
    Since $h$ is trivial on $P_K(\fm)$, we can rewrite this as
    \begin{equation*}
        1 \longrightarrow P_\fm/P_K(\fm) \longrightarrow I_K(\fm)/P_K(\fm) \longrightarrow \Cl(K) \longrightarrow 1 \qedhere
    \end{equation*}
\end{proof}

\begin{example}\label{eg:2_24}
    Let $K = \QQ$, and $m$ a positive integer. Then $I_\QQ((m))/P_\QQ((m)) \cong (\ZZ/m\ZZ)^\times / \{\pm 1\}$, and $I_\QQ((m)\infty)/P_\QQ((m)\infty) \cong (\ZZ/m\ZZ)^\times$ (c.f. \autoref{eg:2_9} and \autoref{eg:2_14}).

    Recall the Artin map $\Phi_\fm : I_\QQ(\fm) \to \Gal(\QQ(\zeta_\fm) / \QQ)$ for $\QQ(\zeta_m)/\QQ$ from \autoref{eg:2_11}, where $\fm = (m) \infty$. It is surjective with $\ker \Phi_\fm = P_\QQ(\fm)$, so we see that $I_\QQ(\fm)/P_\QQ(\fm) \cong \Gal(\QQ(\zeta_m)/\QQ) \cong (\ZZ/m\ZZ)^\times$.
\end{example}

\begin{remark}\label{rem:2_25}
    The idea of class field theory is that generalised ideal class groups are Galois group of abelian extensions of $K$, and that the link is given by the Artin map.
\end{remark}

\noindent We need to know how the Artin map behaves in field towers:

\begin{proposition}\label{prop:2_26}
    Let $K \subseteq L \subseteq M$ be a tower of abelian extensions. Suppose $\fm$ contains all primes of $\cO_K$ that ramify in $M$. Then we have a commutative diagram
    \begin{equation*}
    \begin{tikzcd}
        I_K(\fm) \arrow[r, "\Psi_{M/K,\fm}"] \arrow[rd, "\Phi_{L/K,\fm}"'] & \Gal(M/K) \arrow[d, "\res"] & \sigma \arrow[d, mapsto]\\
                                                                           & \Gal(L/K) & \sigma \vert_L
    \end{tikzcd}
    \end{equation*}
\end{proposition}
\begin{proof}
    Exercise.
\end{proof}

\section{Statements of Global Class Field Theory}

\subsection{The Conductor}

\begin{lemma}\label{lem:3_1}
    Let $L/K$ be abelian, and let $\fm$ be a modulus containing all ramified primes\footnote{finite and infinite} of $K$. Let $\fn$ be another modulus with $\fm \mid \fn$. If $P_K(\fm) \subseteq \ker \Phi_\fm$, then $P_K(\fn) \subseteq \ker \Phi_\fn$.
\end{lemma}
\begin{proof}
    Since $\fm \mid \fn$, $P_K(\fn) \subseteq P_K(\fm)$, and $\Phi_\fn = \Phi_\fm \vert_{I_K(\fn)}$. Then
    \begin{equation*}
        P_K(\fn) \subseteq P_K(\fm) \cap I_K(\fn) \subseteq \ker \Phi_\fm \cap I_K(\fn) = \ker \Phi_\fn \qedhere
    \end{equation*}
\end{proof}

\noindent In the setting of the lemma, this means that if $\ker \Phi_\fm$ is a congruence subgroup for $\fm$, then so is $\ker \Phi_\fn$ for $\fn$.

The is one special modulus:

\begin{theorem}[The Conductor Theorem]\label{thm:3_2}
    Let $L/K$ be abelian, then there is a modulus $\ff$ such that
    \begin{enumerate}
        \item a prime of $K$, finite or infinite, ramifies in $L$ if and only if it divides $\ff(L/K)$;
        \item if $\fm$ is a modulus divisible by all primes of $K$ that ramify in $L$, then $\ker \Phi_\fm$ is a congruence subgroup for $\fm$ if and only if $\ff(L/K) \mid \fm$.
    \end{enumerate}
    The modulus is uniquely determined by $L/K$, and is called the \emph{conductor} of $L/K$.
\end{theorem}

\begin{example}\label{eg:3_3}
    Let $K = \QQ$, and $L = K(\sqrt{d})$, with $d \in \ZZ$ squarefree. Then
    \begin{equation*}
        \ff(L/K) =
        \begin{cases}
            \abs{D} & \text{if } d>0\\
            \abs{D}\infty & \text{if } d<0
        \end{cases}
    \end{equation*}
    where $D$ is the discriminant of $L$, and $\infty$ is the real infinite prime of $\QQ$.
\end{example}

\begin{example}\label{eg:3_4}
    The conductor of the cyclotomic extensions $\QQ(\zeta_m)/\QQ$ is
    \begin{equation*}
        \ff(L/K) =
        \begin{cases}
            1 & \text{if } m \le 2\\
            (\frac{m}{2}) \infty &\text{if } m = 2n, n>1 \text{ odd}\\
            (m) \infty &\text{otherwise}
        \end{cases}
    \end{equation*}
\end{example}

\begin{remark}\label{rem:3_5}
    The conductor is not always the product of ramified primes. In the example sheet, we will see an example of a cubic extensions $L/\QQ$ ramified only at $3$, but for $\fm = (3), (3)\infty$, $\ker(\Phi_{L/\QQ, \fm})$ is not a congruence subgroup, so $\ff(L/Q) \nmid (3)$ or $(3) \infty$.
\end{remark}

\subsection{Artin Reciprocity}

For each abelian extension $L/K$, $\Gal(L/K)$ is a generalised ideal class group:

\begin{theorem}\label{thm:3_6}
    Let $L/K$ be an abelian extension. Let $\fm$ be a modulus divisible by $\ff(L/K)$. Then the Artin map $\Phi_\fm : I_K(\fm) \to \Gal(L/K)$ is surjective, $\ker{\Phi_\fm}$ is a congruence subgroup, and we have an isomorphism $I_K(\fm)/\ker \Phi_\fm \cong \Gal(L/K)$ induced by $\Phi_\fm$.
\end{theorem}

We will next describe the kernel.

\begin{notation}\label{not:3_7}
    Write $N_{L/K} : I_L \to I_K$ for the norm map defined by
    \begin{equation*}
        \prod_i \cp_i^{n_i} \mapsto \prod_i \fp_i^{f_{\cp_i / \fp_i} n_i}
    \end{equation*}
    so in particular, if $\cp \mid \fp$, then $N_{L/K}(\cp) = \fp^{f_{\cp/\fp}}$.
\end{notation}

\begin{definition}\label{def:3_8}
    Let $L/K$ be abelian, $\fm$ a modulus divisible by $\ff_{L/K}$. Then the \emph{norm group} (also known as \emph{Takagi group}) associated to $\fm$ is the congruence subgroup
    \begin{equation*}
        T_{L/K}(\fm) = N_{L/K}(I_L(\fm))P_K(\fm)
    \end{equation*}
    where $I_L(\fm) \subseteq I_L$ consists of fractional ideals that are coprime to $\fm \cO_L$.
\end{definition}

\begin{theorem}[Artin Reciprocity Continued]
    We have $\ker \Phi_\fm = T_{L/K}(\fm)$.
\end{theorem}

We will prove surjectivity of $\Phi_\fm$ using density theorems later in the course.

\begin{proposition}
    Let $L/K$ be abelian, $\fm$ divisible by $\ff(L/K)$. Then $\ker \Phi_\fm \subseteq T_{L/K}(\fm)$.
\end{proposition}
\begin{proof}
    We will prove if for primes, then the result follows\footnote{why?} from multiplicativity of $\Phi_\fm$. Suppose that $\fp \subseteq \cO_K$ is such that $\fp \in \ker \Phi_\fm$. Then $\leg{L/K}{\fp} = 1$, so we know by \autoref{cor:1_7} that $\fp$ splits completely in $L$, and $f_{\cp / \fp} = 1$ for any $\cp \mid \fp$. Suppose $\cp \subseteq \cO_L$ is such that $\cp \mid \fp$, then $N_{L/K}(\cp) = \fp^{f_{\cp/\fp}} = \fp$, so $\fp \in N_{L/K}(I_L(\fm)) \subseteq T_{L/K}(\fm)$.
\end{proof}

\noindent Artin reciprocity gives us information about the decomposition of primes:

\begin{theorem}[Decomposition Theorem]\label{thm:3_10}
    Let $L/K$ be an abelian extension of degree $n$. Let $\fp \subseteq \cO_K$ be unramified in $L$. Let $\fm$ be divisible by $\ff(L/K)$, but not divisible by $\fp$. Write $H = \ker \Phi_\fm$ for the congruence subgroup for $\fm$. Suppose $f$ is the smallest positive integer such that $\fp^f \in H$, i.e. the order of $\fp \pmod{H}$ in $I_K(\fm) / H$. Then $\fp$ decomposes in $L$ into a product $\fp = \cp_1 \ldots \cp_g$, of $g = \frac{n}{f}$ distinct prime ideals of degree $f$ over $\fp$.
\end{theorem}
\begin{proof}
    Let $\fp = \cp_1 \ldots \cp_g$ be the prime decomposition of $\fp$ in $L$. The $\cp_i$ are distinct a $\fp$ is unramified. They have the same inertia degree $f$ (by \autoref{thm:1_2}). We know $f$ is the order of $\leg{L/K}{\fp}$, so under the isomorphism $I_K(\fm) / H \cong \Gal(L/K)$, this means that it is also the order of $\fp \pmod{H}$ in $I_K(\fm) / H$. The result follows from $n = fg$ by \autoref{thm:1_2}.
\end{proof}

\subsection{The Existence Theorem}

Every generalised ideal class group is the Galois group of some abelian extension.

\begin{theorem}[Existence Theorem]\label{thm:3_12}
    Let $\fm$ be a modulus of $F$, and $H$ any congruence subgroup for $\fm$, i.e. $P_K(\fm) \subseteq H \subseteq I_K(\fm)$. Then there is a unique abelian extension $L/K$ with the property that all its ramified (finite and infinite) primes divide $\fm$, such that $H = N_{L/K}(I_L(\fm)) P_K(\fm)$ and $I_K(\fm) / H \xrightarrow{\sim} \Gal(L/K)$ under $\Phi_\fm$.
\end{theorem}

\begin{definition}[Ray Class Field]\label{def:3_13}
    Let $\fm$ be any modulus. Let $H$ be the congruence subgroup $P_K(\fm)$. Then the \emph{ray class field} is the unique abelian extension $K_\fm$ of $K$ such that $P_K(\fm) = \ker(\Phi_{K_\fm / K, \fm})$, given by the Existence Theorem \ref{thm:3_12}.

    In particular, $\Gal(K_\fm / K) \cong I_K(\fm)/P_K(\fm)$ is the ray class group.
\end{definition}

\begin{example}
    Let $m$ be a positive integer, $m \not\equiv 2 \pmod{4}$. Let $K = \QQ$. If $\fm = (m) \infty$, then $K_\fm = \QQ(\zeta_m)$. If $\fm = (m)$, then $K_\fm = \QQ(\zeta_m + \zeta_m^{-1})$, the maximal real subfield of $\QQ(\zeta_m)$.
\end{example}

\end{document}
